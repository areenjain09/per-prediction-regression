# ========================
# Deviance Test
# ========================

source("model_fit.R")

form_null <- as.formula("PER_normalized_adj ~ 1")
fit_null <- betareg(form_null, data = data, link="logit")

ll_null <- logLik(fit_null)
ll_full <- logLik(fit_big)
deviance_stat <- as.numeric(-2 * (ll_null - ll_full))
df_test <- attr(ll_full, "df") - attr(ll_null, "df")
p_value <- pchisq(deviance_stat, df=df_test, lower.tail=FALSE)

cat(sprintf("Deviance test: chi2=%.2f | df=%d | p-value=%.4f\n", deviance_stat, df_test, p_value))
