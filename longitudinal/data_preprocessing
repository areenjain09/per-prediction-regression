# --- Load and Prepare Data ---
data <- read.csv("C:/Users/parul/Downloads/dataset/long.csv")

# Clean missing values
data_clean <- na.omit(data)

# Convert categorical variables
data_clean$POS <- as.factor(data_clean$POS)

# --- Range check for Beta Regression ---
cat("\n=== Checking Range of PER_normalized ===\n")
min_val <- min(data_clean$PER_normalized)
max_val <- max(data_clean$PER_normalized)
cat("Min PER_normalized:", min_val, "\n")
cat("Max PER_normalized:", max_val, "\n")

# Adjust for beta regression boundaries (0,1)
if (min_val <= 0 || max_val >= 1) {
  epsilon <- 0.001
  data_clean$PER_beta <- pmax(epsilon, pmin(1 - epsilon, data_clean$PER_normalized))
  response_var <- "PER_beta"
  cat("Adjusted response variable 'PER_beta' created.\n")
} else {
  data_clean$PER_beta <- data_clean$PER_normalized
  response_var <- "PER_beta"
}
