# 01_data_preparation.R

# Load libraries
library(ggplot2)

# Load data
data <- read.csv("C:/Users/parul/Downloads/dataset/long.csv")

# Clean data
data_clean <- na.omit(data)
data_clean$POS <- as.factor(data_clean$POS)

# Check response variable range
min_val <- min(data_clean$PER_normalized)
max_val <- max(data_clean$PER_normalized)
cat("Min PER_normalized:", min_val, "\n")
cat("Max PER_normalized:", max_val, "\n")

# Adjust response for beta regression
epsilon <- 0.001
if(min_val <= 0 || max_val >= 1){
  data_clean$PER_beta <- pmax(epsilon, pmin(1 - epsilon, data_clean$PER_normalized))
} else {
  data_clean$PER_beta <- data_clean$PER_normalized
}
response_var <- "PER_beta"

# Save cleaned data for next scripts
saveRDS(data_clean, "data_clean.rds")
