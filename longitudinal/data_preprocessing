# --- 01_data_prep.R ---
# Load libraries
library(betareg)
library(lme4)
library(lmtest)
library(car)
library(ggplot2)
library(dplyr)

# Read and prepare longitudinal data
data_long <- read.csv("long.csv")

# Scale efficiency to (0,1) for beta regression
data_long <- data_long %>%
  mutate(Scaled_Eff = (EFF - min(EFF, na.rm = TRUE)) / 
                       (max(EFF, na.rm = TRUE) - min(EFF, na.rm = TRUE)))

# Drop unnecessary vars
exclude_vars <- c("ID", "TEAM", "POS", "EFF")
predictors <- setdiff(names(data_long), c("Scaled_Eff", exclude_vars))

save(data_long, predictors, file = "beta_reg/data_prep.RData")
